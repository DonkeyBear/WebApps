const keys={C:"[I]","C#":"[I#]",D:"[II]","D#":"[II#]",E:"[III]",F:"[IV]","F#":"[IV#]",G:"[V]","G#":"[V#]",A:"[VI]","A#":"[VI#]",B:"[VII]"},pitchNameFix={"#b":"","b#":"","E#":"F",Fb:"E","B#":"C",Cb:"B","C##":"D","D##":"E","F##":"G","G##":"A","A##":"B"};function transpose(){function e(e){for(let t=0;t<12;t++)e=e.replaceAll(Object.keys(keys)[t],Object.values(keys)[t]);for(let t=0;t<12;t++){let n=t+c;n>=12?n-=12:n<0&&(n+=12),e=e.replaceAll(Object.values(keys)[t],Object.keys(keys)[n])}for(let t=0;t<11;t++)e=e.replaceAll(Object.keys(pitchNameFix)[t],Object.values(pitchNameFix)[t]);return e=(e=(e=e.replaceAll("\n","<br>")).replaceAll(" ","&nbsp;")).replaceAll(/([A-G](#|b)?)(\(?(M|maj|major|m|min|minor|dim|sus|dom|aug)?(\+|-|add)?\d*\)?)(\+|-)?\d*\(?(sus\d*)?(M|maj|major)?\d*\)?(\/(([A-G]|\d*)(#|b)?))?/g,'<span class="is-chord">$&</span>')}var t=document.getElementById("chordSheet").value,n=document.getElementById("select-transpose-type").value,c=Number(document.getElementById("transpose-value").value);if(document.getElementById("check-color-picking").checked)(l={}).bg=document.getElementById("input-color-bg").value,l.text=document.getElementById("input-color-text").value,l.chord=document.getElementById("input-color-chord").value,l.chordbg=document.getElementById("input-color-chordbg").value;else var l={bg:"#FFFFFF",text:"#666666",chord:"#246FB5",chordbg:"#EEEEEE"};if(t=(t=t.replaceAll("♯","#")).replaceAll("♭","b"),0!=(c>=-11&&c<=11)){if("capo"==n&&(c=0-c),document.getElementById("check-91pu-optimize").checked){chordSheetArray=t.split("\n");for(let t=0;t<chordSheetArray.length;t++)-1!=chordSheetArray[t].indexOf("|")?chordSheetArray[t]=e(chordSheetArray[t]):chordSheetArray[t]=chordSheetArray[t].replaceAll(" ","&nbsp;");t=chordSheetArray.join("<br>")}else t=e(t);document.getElementById("check-replace-sharp-flat").checked&&(t=(t=(t=(t=t.replaceAll(/[A-G]#/g,"$&SHARP-SYMBOL")).replaceAll(/[A-G]b/g,"$&FLAT-SYMBOL")).replaceAll("#SHARP-SYMBOL",'<span class="music-symbol">♯</span>')).replaceAll("bFLAT-SYMBOL",'<span class="music-symbol">♭</span>')),document.getElementById("check-monospace").checked?document.getElementById("output").style.cssText+="font-family: monospace, Arial, Helvetica, sans-serif;":document.getElementById("output").style.cssText+="font-family: Arial, Helvetica, sans-serif;",document.getElementById("output").innerHTML=t,document.querySelector("body").style.backgroundColor=l.bg,document.getElementById("output").style.cssText+="color:"+l.text;var o=document.getElementsByClassName("is-chord");for(let e=0;e<o.length;e++)o[e].style.cssText+="color:"+l.chord;if(document.getElementById("check-background-color").checked)for(let e=0;e<o.length;e++)o[e].style.cssText+="background-color:"+l.chordbg}else alert("請輸入 -11 到 11 之間的值！")}function switchMenu(e){document.getElementById(e).hidden?document.getElementById(e).hidden=!1:document.getElementById(e).hidden=!0}function clearSheetTextArea(){document.getElementById("chordSheet").value="",document.getElementById("transpose-value").value="",document.getElementById("chordSheet").focus()}function changeFontSize(e){let t=document.getElementById("input-fontSize").innerHTML;t=t.slice(0,-3),0!=(t=Number(t)+e)&&(document.getElementById("input-fontSize").innerHTML=t+" px",document.getElementById("output").style.cssText+="font-size: "+t+"px;")}function changeLineHeight(e){let t=document.getElementById("input-lineHeight").innerHTML;t=t.slice(0,-3),(t=Number(t)+e)<0||(document.getElementById("input-lineHeight").innerHTML=t+" px",document.getElementById("output").style.cssText+="line-height: "+t+"px;")}function changePaddingLeft(e){let t=document.getElementById("input-padding").innerHTML;t=t.slice(0,-1),(t=Number(t)+e)<0||t>100||(document.getElementById("input-padding").innerHTML=t+"%",document.getElementById("output").style.cssText+="padding-left: "+t+"%;")}