const keys={C:"[I]","C#":"[I#]",D:"[II]","D#":"[II#]",E:"[III]",F:"[IV]","F#":"[IV#]",G:"[V]","G#":"[V#]",A:"[VI]","A#":"[VI#]",B:"[VII]"},pitchNameFix={"#b":"","b#":"","E#":"F",Fb:"E","B#":"C",Cb:"B","C##":"D","D##":"E","F##":"G","G##":"A","A##":"B"};var chordSheetLength=0,chordSheetLengthLast=0;function transpose(){function e(e){for(let t=0;t<12;t++)e=e.replaceAll(Object.keys(keys)[t],Object.values(keys)[t]);for(let t=0;t<12;t++){let l=(t+n)%12;l<0&&(l+=12),e=e.replaceAll(Object.values(keys)[t],Object.keys(keys)[l])}for(let t=0;t<11;t++)e=e.replaceAll(Object.keys(pitchNameFix)[t],Object.values(pitchNameFix)[t]);return e=(e=(e=e.replaceAll("\n","<br>")).replaceAll(" ","&nbsp;")).replaceAll(/([A-G](#|b)?)(\(?(M|maj|major|m|min|minor|dim|sus|dom|aug)?(\+|-|add)?\d*\)?)(\+|-)?\d*\(?(sus\d*)?(M|maj|major)?\d*\)?(\/(([A-G]|\d*)(#|b)?))?/g,'<span class="is-chord">$&</span>')}var t=document.getElementById("chordSheet").value,l=document.getElementById("select-transpose-type").value,n=Number(document.getElementById("transpose-value").value);if(document.getElementById("check-color-picking").checked)(c={}).bg=document.getElementById("input-color-bg").value,c.text=document.getElementById("input-color-text").value,c.chord=document.getElementById("input-color-chord").value,c.chordbg=document.getElementById("input-color-chordbg").value;else var c={bg:"#FFFFFF",text:"#666666",chord:"#246FB5",chordbg:"#EEEEEE"};if(t=(t=t.replaceAll("♯","#")).replaceAll("♭","b"),n%=12,document.getElementById("transpose-value").value=n,"capo"==l&&(n=0-n),document.getElementById("check-91pu-optimize").checked){chordSheetArray=t.split("\n");for(let t=0;t<chordSheetArray.length;t++)-1!=chordSheetArray[t].indexOf("|")?chordSheetArray[t]=e(chordSheetArray[t]):chordSheetArray[t]=chordSheetArray[t].replaceAll(" ","&nbsp;");t=(t=(t=(t=chordSheetArray.join("<br>")).replaceAll(/[A-G](#|b)/g,"$&MAKE-THIS-SUP")).replaceAll("#MAKE-THIS-SUP","<sup>#</sup>")).replaceAll("bMAKE-THIS-SUP","<sup>b</sup>")}else t=e(t);document.getElementById("check-replace-sharp-flat").checked&&(t=(t=(t=(t=t.replaceAll(/([A-G]|(<sup>))#/g,"$&SHARP-SYMBOL")).replaceAll(/([A-G]|(<sup>))b/g,"$&FLAT-SYMBOL")).replaceAll("#SHARP-SYMBOL",'<span class="music-symbol">♯</span>')).replaceAll("bFLAT-SYMBOL",'<span class="music-symbol">♭</span>')),document.getElementById("check-monospace").checked?document.getElementById("output").style.cssText+="font-family: monospace, Arial, Helvetica, sans-serif;":document.getElementById("output").style.cssText+="font-family: Arial, Helvetica, sans-serif;",document.getElementById("output").innerHTML=t,document.querySelector("body").style.backgroundColor=c.bg,document.getElementById("output").style.cssText+="color:"+c.text;var o=document.getElementsByClassName("is-chord");for(let e=0;e<o.length;e++)o[e].style.cssText+="color:"+c.chord;if(document.getElementById("check-background-color").checked)for(let e=0;e<o.length;e++)o[e].style.cssText+="background-color:"+c.chordbg}function switchMenu(e){document.getElementById(e).hidden?document.getElementById(e).hidden=!1:document.getElementById(e).hidden=!0}function clearSheetTextArea(){document.getElementById("chordSheet").value="",document.getElementById("chordSheet").focus()}function changeFontSize(e){let t=document.getElementById("input-fontSize").value;t=t.replaceAll(/\D/g,"").trim(),0!=e&&(t=Number(t)+e),0!=t&&(document.getElementById("input-fontSize").value=t+"px",document.getElementById("output").style.cssText+="font-size: "+t+"px;")}function changeLineHeight(e){let t=document.getElementById("input-lineHeight").value;t=t.replaceAll(/\D/g,"").trim(),0!=e&&(t=Number(t)+e),t<0||(document.getElementById("input-lineHeight").value=t+"px",document.getElementById("output").style.cssText+="line-height: "+t+"px;")}function cleanUpBreakLine(e){let t=document.getElementById(e);if(chordSheetLengthLast=chordSheetLength,(chordSheetLength=t.value.length)-chordSheetLengthLast>1){let e=(t.value.match(/\n/g)||[]).length;2*(t.value.match(/\n\n/g)||[]).length==e&&(t.value=t.value.replaceAll("\n\n","\n"))}}function copyValue(e,t){document.getElementById(t).value=document.getElementById(e).value}document.getElementById("input-fontSize").value="14px",document.getElementById("input-lineHeight").value="22px",transpose();